# Cursor AI Rules for BreakLoop-Native Project

## Kotlin File Editing - CRITICAL RULE

**BEFORE editing ANY `.kt` file, ALWAYS check the file path:**

### ❌ WRONG - Never edit these:
- `android/app/src/main/java/.../*.kt`
- These files are AUTO-GENERATED by Expo and will be OVERWRITTEN

### ✅ CORRECT - Always edit these:
- `plugins/src/android/java/.../*.kt`
- These are the SOURCE OF TRUTH

### Workflow:
1. User asks to modify a Kotlin file
2. AI checks: Does path contain `android/app/`?
   - If YES → Find corresponding file in `plugins/src/android/` and edit that instead
   - If NO → Proceed with edit
3. After editing `plugins/` file, rebuild: `npx expo run:android`

### Why?
- Expo copies `plugins/` → `android/app/` during build
- Manual edits to `android/app/` get lost on next build
- Only `plugins/` files are tracked by git


## Project Structure

- React Native (Expo) with TypeScript
- Native modules in `plugins/src/android/` (Kotlin)
- Intervention state machine in `src/core/intervention/` (framework-agnostic)
- OS Trigger Brain in `src/os/osTriggerBrain.ts` (manages intervention logic)

## Documentation

Always check these docs before making changes:
- `docs/KOTLIN_FILE_WORKFLOW.md` - Kotlin file editing rules
- `design/ux/states.md` - UI state definitions
- `design/ux/flows.md` - User flow documentation

